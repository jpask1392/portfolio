import { useState, useEffect } from "react";

const useSignedInAccount = () => {
  const [account, setAccount] = useState({ address: false });

  // Fetch user when:
  useEffect(() => {
    const handler = async () => {
      try {
        const res = await fetch("/api/me");
        const json = await res.json();
        setAccount((x) => ({ ...x, address: json.address }));
      } catch (_error) {}
    };
    // 1. page loads
    handler();

    // 2. window is focused (in case user logs out of another window)
    window.addEventListener("focus", handler);
    return () => window.removeEventListener("focus", handler);
  }, []);

  return { account, setAccount };
};

export default useSignedInAccount;
